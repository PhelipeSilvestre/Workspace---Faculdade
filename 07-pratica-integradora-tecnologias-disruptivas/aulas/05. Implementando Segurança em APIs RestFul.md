**Implementando Segurança em APIs RestFul**

Ao desenvolvermos um projeto de software é comum considerarmos os requisitos funcionais e não funcionais do mesmo. Entretanto, ainda é pouco comum considerar, entre os aspectos não funcionais, toda a parte de segurança de software. Tal questão, normalmente, é pensada nas etapas finais do processo de desenvolvimento, fato esse que acaba gerando maiores custos (recursos, tempo, retrabalho, etc.) se comparado com a adoção de esforços, para planejar a segurança da aplicação nas etapas iniciais do projeto.

Antes de tratarmos da aplicação da segurança fazendo uso do Spring Boot, é importante reforçarmos alguns conceitos a respeito de tal tema. Falar de segurança na engenharia de software envolve tópicos como confiabilidade, tolerância a falhas, segurança da informação, controle de acesso, entre outros. Nesse sentido, confiabilidade e tolerância a falhas caminham juntos, estando ambos relacionados também a outro aspecto, o de maturidade do sistema e sua capacidade de se recuperar mediante a falhas. Já a segurança da informação está voltada para a proteção da aplicação, e seus dados, como um todo, envolvendo toda a preocupação com o controle de acesso, por exemplo.

Além dos aspectos mais amplos tratados acima, há alguns outros mais específicos, relacionados aos padrões de mercado/indústria para implementação de segurança em aplicações. Nesse sentido, cabe destacar o Protocolo OAuth 2.0. Tal protocolo, mantido por um grupo de trabalho (IETF OAuth Working Group) e que continua recebendo atualizações, especifica regras e fluxos para o processo de autenticação e controle de acesso.

Ao longo desse módulo daremos atenção justamente à segurança da informação – mais precisamente ao controle de acesso, seguindo os princípios do OAuth, suportado pelo módulo de segurança do Spring. Nesse sentido, veremos como proteger nossa aplicação, do ponto de vista da autenticação e do controle de acesso, a fim de impedir que pessoas ou sistemas não autorizados a acessem e também a fim de permitir que os seus diferentes recursos sejam acessíveis apenas a quem de direito. Enquanto a autenticação se preocupa com a questão “quem é você?” ou, melhor, “quem está tentando acessar a aplicação”, o controle de acesso (também chamado de autorização) lida com a pergunta “o que você está autorizado a fazer?” ou “o que um determinado cliente, que está acessando a aplicação, está autorizado a fazer?”.

Para responder a essas duas questões, o Spring possui uma arquitetura dedicada de segurança. Dentro da mesma é possível utilizar todos os recursos disponibilizados pelo framework, além de também ser possível customizá-los. Por se tratarem de assuntos bastante extensos, não abordaremos neste módulo, os detalhes da arquitetura em questão, empregada pelo Spring e providos pelo OAuth. Por outro lado, veremos como aplicar tanto a autenticação como a autorização em uma API Restful: protegeremos todo o acesso à API através de credenciais e configuraremos as rotas públicas e privadas, ou seja, quais endpoints poderão ser acessados sem a necessidade de credenciais, como os recursos de criação de usuário e autenticação, por exemplo. Além disso, estabeleceremos a base necessária para que, usando o modelo fornecido pelo Spring, você possa definir o controle de acesso a cada endpoint de acordo com o perfil do usuário.

O primeiro passo para protegermos nossa API consiste na configuração da dependência – biblioteca “spring-boot-starter-security”. Em uma API pré-existente ou em uma nova API (utilize o site start.spring.io como ponto de partida, adicionando lá mesmo as dependências necessárias, incluindo a de segurança), a partir do gerenciador de dependências de sua preferência, insira os pacotes em questão. Abaixo, podemos ver a linha a ser inserida no “pom.xml” (em projetos Maven):
